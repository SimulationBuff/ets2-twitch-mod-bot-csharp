<Window x:Class="ETS2TwitchModBot.App.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:ETS2TwitchModBot.App"
        Title="ETS2 Twitch Mod Bot" Height="800" Width="1200"
        MinHeight="600" MinWidth="900">
  <Grid Margin="10">
    <Grid.RowDefinitions>
      <!-- Header row: buttons and status -->
      <RowDefinition Height="Auto" />
      <!-- Main content: tabs and settings -->
      <RowDefinition Height="*" />
      <!-- Logs panel -->
      <RowDefinition Height="220" />
    </Grid.RowDefinitions>

    <!-- Header: Start/Stop controls and status -->
    <DockPanel Grid.Row="0" Margin="0,0,0,8" LastChildFill="True">
      <StackPanel Orientation="Horizontal" DockPanel.Dock="Left" VerticalAlignment="Center">
        <Button x:Name="StartButton" Content="Start" Width="100" Margin="0,0,8,0"/>
        <Button x:Name="StopButton" Content="Stop" Width="100" Margin="0,0,8,0" IsEnabled="False"/>
        <Button x:Name="RefreshModsButton" Content="Refresh Mods" Width="120" Margin="0,0,8,0"/>
      </StackPanel>

      <StackPanel Orientation="Horizontal" DockPanel.Dock="Right" VerticalAlignment="Center" >
        <TextBlock Text="Status:" VerticalAlignment="Center" Margin="0,0,6,0" FontWeight="SemiBold"/>
        <TextBlock x:Name="StatusTextBlock" Text="Stopped" VerticalAlignment="Center" Foreground="Gray"/>
      </StackPanel>
    </DockPanel>

    <!-- Main area: Tabs (left) and Settings (right) -->
    <Grid Grid.Row="1">
      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="3*" />
        <ColumnDefinition Width="12" /> <!-- spacer -->
        <ColumnDefinition Width="2*" />
      </Grid.ColumnDefinitions>

      <!-- Left: Tabs for Mods and DLCs -->
      <Border Grid.Column="0" Background="{DynamicResource PanelBackgroundBrush}" Padding="8" CornerRadius="6">
        <DockPanel LastChildFill="True">
          <TabControl x:Name="MainTabControl" Margin="0">
            <!-- Mods Tab -->
            <TabItem Header="Mods">
              <Grid>
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- Filters / search row -->
                <DockPanel Grid.Row="0" Margin="0,0,0,8">
                  <TextBox x:Name="ModSearchBox" Width="240" Margin="0,0,8,0" VerticalAlignment="Center" PlaceholderText="Search mods..." />
                  <Button x:Name="RescanModsButton" Content="Rescan Folder" Width="110" VerticalAlignment="Center" />
                  <StackPanel Orientation="Horizontal" DockPanel.Dock="Right">
                    <TextBlock VerticalAlignment="Center" Margin="8,0,6,0" FontStyle="Italic" Foreground="Gray" Text="Sort:"/>
                    <ComboBox x:Name="ModSortCombo" Width="140" SelectedIndex="0">
                      <ComboBoxItem>By Filename</ComboBoxItem>
                      <ComboBoxItem>By Load Order</ComboBoxItem>
                      <ComboBoxItem>By Display Name</ComboBoxItem>
                    </ComboBox>
                  </StackPanel>
                </DockPanel>

                <!-- Mods list -->
                <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
                  <ItemsControl x:Name="ModsItemsControl" ItemTemplate="{StaticResource ModInfoTemplate}">
                    <!-- Items bound programmatically -->
                  </ItemsControl>
                </ScrollViewer>
              </Grid>
            </TabItem>

            <!-- DLCs Tab -->
            <TabItem Header="DLCs">
              <Grid Margin="4">
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Detected DLCs (from Steam folder and profiles)" Margin="0,0,0,6" FontWeight="SemiBold"/>
                <ListBox Grid.Row="1" x:Name="DlcsListBox" Background="White" BorderBrush="#EEE" BorderThickness="1" Padding="6" />
              </Grid>
            </TabItem>

            <!-- Profile Preview Tab (optional) -->
            <TabItem Header="Profiles">
              <Grid Margin="4">
                <Grid.RowDefinitions>
                  <RowDefinition Height="Auto"/>
                  <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <TextBlock Grid.Row="0" Text="Profiles" FontWeight="SemiBold" Margin="0,0,0,6"/>
                <Grid Grid.Row="1">
                  <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="2*" />
                    <ColumnDefinition Width="*" />
                  </Grid.ColumnDefinitions>

                  <ListBox x:Name="ProfilesListBox" Grid.Column="0" Margin="0,0,8,0"/>
                  <TextBox x:Name="ProfileContentBox" Grid.Column="1" IsReadOnly="True" TextWrapping="Wrap" VerticalScrollBarVisibility="Auto"/>
                </Grid>
              </Grid>
            </TabItem>
          </TabControl>
        </DockPanel>
      </Border>

      <!-- Right: Settings panel -->
      <Border Grid.Column="2" Background="{DynamicResource PanelBackgroundBrush}" Padding="8" CornerRadius="6">
        <StackPanel>
          <TextBlock Text="Settings" FontSize="14" FontWeight="Bold" Margin="0,0,0,8"/>
          <StackPanel Orientation="Vertical" Margin="0,0,0,8">
            <TextBlock Text="ETS2 Mod Folder" FontWeight="SemiBold" />
            <TextBox x:Name="Ets2ModPathBox" Margin="0,4,0,8"/>

            <TextBlock Text="ETS2 Profiles Folder" FontWeight="SemiBold" />
            <TextBox x:Name="Ets2ProfilesPathBox" Margin="0,4,0,8"/>

            <TextBlock Text="ETS2 Steam Install Path" FontWeight="SemiBold" />
            <TextBox x:Name="Ets2SteamPathBox" Margin="0,4,0,8"/>

            <TextBlock Text="Steam Web API Key (optional)" FontWeight="SemiBold" />
            <TextBox x:Name="SteamApiKeyBox" Margin="0,4,0,8" />

            <TextBlock Text="Twitch OAuth Token (env preferred)" FontWeight="SemiBold" />
            <PasswordBox x:Name="TwitchTokenBox" Margin="0,4,0,8" />

            <TextBlock Text="Twitch Channel" FontWeight="SemiBold" />
            <TextBox x:Name="TwitchChannelBox" Margin="0,4,0,8" />

            <WrapPanel Margin="0,8,0,0">
              <Button x:Name="SaveSettingsButton" Content="Save" Width="80" Margin="0,0,8,0"/>
              <Button x:Name="LoadFromEnvButton" Content="Load from Environment" Width="160"/>
            </WrapPanel>
          </StackPanel>

          <Separator Margin="0,8,0,8"/>

          <TextBlock Text="Actions" FontSize="12" FontWeight="Bold" Margin="0,0,0,8"/>
          <StackPanel Orientation="Vertical">
            <Button x:Name="OpenModsFolderButton" Content="Open Mods Folder" Margin="0,0,0,6"/>
            <Button x:Name="OpenProfilesFolderButton" Content="Open Profiles Folder" Margin="0,0,0,6"/>
            <Button x:Name="ClearCacheButton" Content="Clear Mod Cache" Margin="0,0,0,6"/>
          </StackPanel>

          <StackPanel VerticalAlignment="Bottom" Margin="0,12,0,0">
            <TextBlock Text="Tip: Store secrets in environment variables or CI secrets. Avoid committing tokens to disk." FontStyle="Italic" Foreground="Gray" TextWrapping="Wrap" />
          </StackPanel>
        </StackPanel>
      </Border>
    </Grid>

    <!-- Logs: append-only text area -->
    <Border Grid.Row="2" Background="{DynamicResource PanelBackgroundBrush}" Padding="8" CornerRadius="6" Margin="0,8,0,0">
      <Grid>
        <Grid.ColumnDefinitions>
          <ColumnDefinition Width="*" />
          <ColumnDefinition Width="Auto" />
        </Grid.ColumnDefinitions>

        <TextBox x:Name="LogsTextBox"
                 Grid.Column="0"
                 IsReadOnly="True"
                 VerticalScrollBarVisibility="Auto"
                 HorizontalScrollBarVisibility="Auto"
                 TextWrapping="Wrap"
                 AcceptsReturn="True"
                 FontFamily="Consolas"
                 Background="White"
                 BorderBrush="#EEE" />

        <StackPanel Grid.Column="1" Margin="8,0,0,0" VerticalAlignment="Top">
          <Button x:Name="ClearLogsButton" Content="Clear" Width="80" Margin="0,0,0,8"/>
          <Button x:Name="SaveLogsButton" Content="Save..." Width="80"/>
        </StackPanel>
      </Grid>
    </Border>
  </Grid>
</Window>
